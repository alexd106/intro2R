<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercise Solutions</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162377463-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162377463-2');
</script>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro2R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-university"></span>
     
    Learn R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="howto.html">
        <span class="fa fa-tv"></span>
         
        How-to
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="lectures.html">
        <span class="fa fa-chalkboard"></span>
         
        Lectures
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-file-contract"></span>
     
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exercises.html">
        <span class="fa fa-folder"></span>
         
        Excercises
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="exercise_solutions.html">
        <span class="fa fa-folder"></span>
         
        Exercise solutions
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li>
  <a href="Tutorials.html">
    <span class="fa fa-desktop"></span>
     
    Tutorials
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="syllabus.html">
        <span class="fa fa-graduation-cap"></span>
         
        Syllabus
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="People.html">
        <span class="fa fa-user-friends"></span>
         
        People
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://forms.gle/U7MbyhRWyLomjyFY7">
        <span class="fa fa-commenting"></span>
         
        Feedback
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="People.html">
        <span class="fa fa-envelope fa-lg"></span>
         
        Contact
      </a>
    </li>
    <li>
      <a href="https://github.com/alexd106/intro2R">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercise Solutions</h1>

</div>


<p> </p>
<div id="exercise-5-basic-statistics-in-r" class="section level2">
<h2>Exercise 5: Basic statistics in R</h2>
<p> </p>
<p>Read <a href="https://intro2r.com/stats_r.html">Chapter 6</a> to help
you complete the questions in this exercise.</p>
<p> </p>
<p>Although this short course is primarily focussed on introducing you
to R, it wouldn’t be complete if we didn’t have a peek at some of R’s
statistical roots. Having said that, this will be a very brief overview
with very little in the way of theory so don’t worry if you get a little
lost - this is just a taster, the main course is still to come!</p>
<p> </p>
<p>1. Download the datafile <em>‘prawnGR.CSV’</em> from the <strong><a
href="data.html"><i class="fa fa-download"></i> Data</a></strong> link
and save it to the <code>data</code> directory. Import these data into R
and assign to a variable with an appropriate name. These data were
collected from an experiment to investigate the difference in growth
rate of the <a
href="https://en.wikipedia.org/wiki/Penaeus_monodon">giant tiger
prawn</a> (<em>Penaeus monodon</em>) fed either an artificial or natural
diet. Have a quick look at the structure of this dataset and plot the
growth rate versus the diet using an appropriate plot. How many
observations are there in each diet treatment?</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>prawns <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&#39;data/prawnGR.CSV&#39;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>prawns <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/prawnGR.CSV&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># take a look at the data</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">str</span>(prawns)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co"># &#39;data.frame&#39;:   60 obs. of  2 variables:</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#  $ GRate: num  9.77 10.29 10.05 10.08 9.31 ...</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#  $ diet : Factor w/ 2 levels &quot;Artificial&quot;,&quot;Natural&quot;:...</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="fu">summary</span>(prawns)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#      GRate                diet   </span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#  Min.   : 7.395   Artificial:30  </span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#  1st Qu.: 9.550   Natural   :30  </span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#  Median : 9.943                  </span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#  Mean   : 9.920                  </span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#  3rd Qu.:10.344                  </span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#  Max.   :11.632         </span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="co"># how many replicates for each level of diet</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="fu">table</span>(prawns<span class="sc">$</span>diet)</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co"># Artificial    Natural </span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="co">#         30         30 </span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="co"># or use xtabs</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> diet, <span class="at">data =</span> prawns)</span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a><span class="co"># produce a boxplot</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="fu">boxplot</span>(GRate <span class="sc">~</span> diet, <span class="at">data =</span> prawns, <span class="at">xlab =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Growth Rate&quot;</span>)</span></code></pre></div>
<p> </p>
<p>2. You want to compare the difference in growth rate between the two
diets using a two sample t-test. Before you conduct the test, you need
to assess the normality and equal variance assumptions. Use the function
<code>shapiro.test()</code> to assess normality of growth rate for each
diet separately (Hint: use your indexing skills to extract the growth
rate for each diet <code>GRate[diet=='Natural']</code> first). Use the
function <code>var.test()</code> to test for equal variance (see
<code>?var.test</code> for more information or <a
href="https://intro2r.com/one-and-two-sample-tests.html#one-and-two-sample-tests">Section
6.1</a> of the book for more details). Are your data normally
distributed and have equal variances? Note: We don’t really advocate
using these ‘approaches’ for assessing the normality and equal variance
assumptions assumptions but include them here as many people will still
want to use them. A much better way to assess assumptions is to use
diagnostic plots of the residuals (see Q6 for an example).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># test normality assumption</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># Do not perform test on all data together, i.e.</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">shapiro.test</span>(prawns<span class="sc">$</span>GRate) <span class="co"># this is wrong!!</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co"># Need to test for departures from normality for each group </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># separately. Remember your indexing [ ]</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">shapiro.test</span>(prawns<span class="sc">$</span>GRate[prawns<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Artificial&quot;</span>])</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a> </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#         Shapiro-Wilk normality test</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co"># data:  prawns$GRate[prawns$diet == &quot;Artificial&quot;] </span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co"># W = 0.9486, p-value = 0.1553</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">shapiro.test</span>(prawns<span class="sc">$</span>GRate[prawns<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Natural&quot;</span>])</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#         Shapiro-Wilk normality test</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co"># data:  prawns$GRate[prawns$diet == &quot;Natural&quot;] </span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co"># W = 0.9598, p-value = 0.307</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co"># Therefore no evidence to reject the Null hypothesis and data are normally distributed</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co"># However much better assessment of normality is to use a quantile - quantile plot</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co"># looking for points to lie along the line for normality</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="fu">qqnorm</span>(prawns<span class="sc">$</span>GRate[prawns<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Artificial&quot;</span>])</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="fu">qqline</span>(prawns<span class="sc">$</span>GRate[prawns<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Artificial&quot;</span>])</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="fu">qqnorm</span>(prawns<span class="sc">$</span>GRate[prawns<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Natural&quot;</span>])</span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="fu">qqline</span>(prawns<span class="sc">$</span>GRate[prawns<span class="sc">$</span>diet <span class="sc">==</span> <span class="st">&quot;Natural&quot;</span>])</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co"># test for equal variance</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="co"># if normal</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="co"># Null hypothesis Ho: variances are equal</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a><span class="fu">var.test</span>(prawns<span class="sc">$</span>GRate <span class="sc">~</span> prawns<span class="sc">$</span>diet)</span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="co">#         F test to compare two variances</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a><span class="co"># data:  prawns$GRate by prawns$diet </span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="co"># F = 1.9629, num df = 29, denom df = 29, p-value = 0.07445</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a><span class="co"># alternative hypothesis: true ratio of variances is not equal to 1 </span></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a><span class="co"># 95 percent confidence interval:</span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a><span class="co">#  0.9342621 4.1240043 </span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a><span class="co"># sample estimates:</span></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="co"># ratio of variances </span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="co">#           1.962881 </span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a><span class="co"># No evidence to reject null hypothesis (P=0.07) therefore no </span></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a><span class="co"># difference in variance</span></span></code></pre></div>
<p> </p>
<p>3. Conduct a two sample t-test using the <code>t.test()</code>
function (<a
href="https://intro2r.com/one-and-two-sample-tests.html#one-and-two-sample-tests">Section
6.1</a>of the book). Use the argument <code>var.equal = TRUE</code> to
perform the t-test assuming equal variances. What is the null hypothesis
you want to test? Do you reject or fail to reject the null hypothesis?
What is the value of the t statistic, degrees of freedom and p value?
How would you summarise these summary statistics in a report?</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># conduct t-test assuming equal variances</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># Null hypothesis Ho: no difference in growth rate </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># between prawns fed on artificial diet or Natural diet</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">t.test</span>(GRate <span class="sc">~</span> diet, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> prawn)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#         Two Sample t-test</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># data:  prawns$GRate by prawns$diet </span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># t = -1.3259, df = 58, p-value = 0.1901</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># alternative hypothesis: true difference in means is not equal to 0 </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co"># 95 percent confidence interval:</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#  -0.6319362  0.1283495 </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co"># sample estimates:</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co"># mean in group Artificial    mean in group Natural </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#                 9.794133                10.045927 </span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>                </span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co"># No evidence to reject the Null hypothesis, therefore no </span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co"># difference in growth rate of prawns fed on either artificial </span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co"># or natural diet (t = -1.33, df = 58, p = 0.19).</span></span></code></pre></div>
<p> </p>
<p>4. An alternative (but equivalent) way to compare the mean growth
rate between diets is to use a linear model. Use the <code>lm()</code>
function to fit a linear model with <code>GRate</code> as the response
variable and <code>diet</code> as an explanatory variable (see <a
href="https://intro2r.com/simple-lm.html#simple_lm">Section 6.3</a> for
a very brief introduction to linear modelling). Assign
(<code>&lt;-</code>) the results of the linear model to a variable with
an appropriate name (i.e. <code>growth.lm</code>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>growth.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(GRate <span class="sc">~</span> diet, <span class="at">data =</span> prawns)</span></code></pre></div>
<p> </p>
<p>5. Produce an ANOVA table for the fitted model using the
<code>anova()</code> function i.e. <code>anova(growth.lm)</code>.
Compare the ANOVA p value to the p value obtained using a t-test. What
do you notice? What is the value of the F statistics and degrees of
freedom? How would you summarise these results in a report?</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># produce the ANOVA table</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">anova</span>(growth.lm)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># Analysis of Variance Table</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># Response: GRate</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co"># diet       1  0.951 0.95100  1.7579 0.1901</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co"># Residuals 58 31.377 0.54098  </span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co"># notice the p value is the same as for the t-test</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co"># also if you square the t statistic from the t-test</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co"># you get the F statistic from the linear model.</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co"># They&#39;re the same test</span></span></code></pre></div>
<p> </p>
<p>6. Assess the normality and equal variance assumptions by plotting
the residuals of the fitted model (see <a
href="https://intro2r.com/simple-lm.html#simple_lm">Section 6.3</a> for
more details). Split the plotting device into 2 rows and 2 columns using
<code>par(mfrow=c(2,2))</code> so you can fit four plots on a single
device. Use the <code>plot()</code> function on your fitted model
(<code>plot(growth.lm)</code>) to plot the graphs. Discuss with an
instructor how to interpret these plots. What are your conclusions?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># plot the residuals to assess normality and equal variance</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co"># divide the plotting device into 2 rows and 2 columns to get all</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># the graphs on one device</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="fu">plot</span>(growth.lm)  </span></code></pre></div>
<p> </p>
<p>7. Download the datafile <em>‘Gigartina.CSV’</em> from the <strong><a
href="data.html"><i class="fa fa-download"></i> Data</a></strong> link
and save it to the <code>data</code> directory. Import the dataset into
R and assign the dataframe an appropriate name. These data were
collected from a study to examine the change in <code>diameter</code> of
red algae <a
href="https://en.wikipedia.org/wiki/Mastocarpus_stellatus"><em>Mastocarpus
stellatus</em></a> spores grown in three different diatom cultures and a
control group grown in artificial seawater (<code>diatom.treat</code>
variable). Use the function <code>str()</code> to examine the dataframe.
How many replicates are there per diatom treatment? Use an appropriate
plot to examine whether there are any obvious differences in diameter
between the treatments.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>gigartina <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/Gigartina.CSV&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>gigartina <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/Gigartina.CSV&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">str</span>(gigartina)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># &#39;data.frame&#39;:\t40 obs. of 2 variables: $ diameter : int 110 115 110 108 109 101 101 98 120 ...  $</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co"># diatom.treat: Factor w/ 4 levels &#39;ASGM&#39;,&#39;Sdecl&#39;,..: 1 1...</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">table</span>(gigartina<span class="sc">$</span>diatom.treat)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co"># ASGM Sdecl Sexpo Sstat 10 10 10 10</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co"># or use xtabs</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span>diatom.treat, <span class="at">data =</span> gigartina)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co"># diatom.treat ASGM Sdecl Sexpo Sstat 10 10 10 10</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co"># plot these data</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="fu">boxplot</span>(diameter <span class="sc">~</span> diatom.treat, <span class="at">data =</span> gigartina, <span class="at">xlab =</span> <span class="st">&quot;diatom treatment&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;diameter (um)&quot;</span>)</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co"># or if you want to do the fancy um symbol correctly</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="fu">boxplot</span>(diameter <span class="sc">~</span> diatom.treat, <span class="at">data =</span> gigartina, <span class="at">xlab =</span> <span class="st">&quot;diatom treatment&quot;</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;diameter&quot;</span>,</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>    <span class="st">&quot; (&quot;</span>, mu, <span class="st">&quot;m)&quot;</span>)))</span></code></pre></div>
<p> </p>
<p>8. You wish to compare the mean diameter of <em>Metacarpus</em> grown
in the four treatment groups (<code>ASGM</code>, <code>Sdecl</code>,
<code>Sexpo</code>, <code>Sstat</code>) using a one-way analysis of
variance (ANOVA). What is your null hypothesis?</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># The null hypothesis Ho: there is no difference in mean diameter </span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># of the spores between the different treatment groups</span></span></code></pre></div>
<p> </p>
<p>9. We will conduct the ANOVA using the linear model function
<code>lm()</code> once again. Make sure you know which of the variables
is your response variable and which is your explanatory variable (ask an
instructor if in doubt). Fit the linear model and assign the model
output to a variable with an appropriate name
(i.e. <code>gigartina.lm</code>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>gigartina.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(diameter <span class="sc">~</span> diatom.treat, <span class="at">data =</span> gigartina)</span></code></pre></div>
<p> </p>
<p>10. Produce an ANOVA table using the <code>anova()</code> function.
What is the value of the p value? Do you reject or fail to reject the
null hypothesis? What is the value of the <em>F</em> statistic and
degrees of freedom? How would you report these summary statistics in a
report?</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">anova</span>(gigartina.lm)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co"># Analysis of Variance Table</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># Response: diameter</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#              Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># diatom.treat  3 1880.3  626.76  22.775 1.929e-08 ***</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># Residuals    36  990.7   27.52                      </span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co"># reject the null hypothesis, therefore there is a significant </span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co"># difference in the diameter between the treatment groups</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co"># (F_3,36 = 22.78, p &lt; 0.001)</span></span></code></pre></div>
<p> </p>
<p>11. Assess the assumptions of normality and equal variance of the
residuals by producing the residual plots as before. Don’t forget to
split the plotting device into 2 rows and 2 columns before plotting.
Discuss with an instructor whether the residuals meet these assumptions.
Do you accept this model as acceptable?</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">plot</span>(gigartina.lm)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># residual plots look ok to me!</span></span></code></pre></div>
<p> </p>
<p>12. Let’s compare the treatment group means to determine which
treatment group is different from other treatment groups. In general,
you should be careful with these types of post-hoc comparisons,
especially if you have a large number of groups (There are much better
ways to do this, but that’s for another course!). In this case we only
have 4 groups, and therefore we will use Tukey’s Honest significant
difference to perform the comparisons and control for type 1 error rate
(rejecting a true null hypothesis).</p>
<p> </p>
<p>13. We will use the function <code>TukeyHSD()</code> from the
<code>mosaic</code> package to perform these comparisons (you will need
to install this package first and then use <code>library(mosaic)</code>
to make the function available). Which groups are different from each
other if we use the p-value cutoff (alpha) of p &lt; 0.05?</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># what group mean is different from what? Post-hoc comparisons.</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># we will use Tukey&#39;s Honest significant difference method </span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># to compare group means.</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># install.packages(&#39;mosaic&#39;)</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># compare the group means using TukeysHSD method</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="fu">TukeyHSD</span>(gigartina.lm)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a> </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#   Tukey multiple comparisons of means</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#     95% family-wise confidence level</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co"># Fit: aov(formula = diameter ~ diatom.treat, data = gigartina)</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co"># $diatom.treat</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#              diff         lwr       upr     p adj</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co"># Sdecl-ASGM  -14.3 -20.6184102  -7.98159 0.0000030</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co"># Sexpo-ASGM   -8.9 -15.2184102  -2.58159 0.0029489</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co"># Sstat-ASGM  -18.3 -24.6184102 -11.98159 0.0000000</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co"># Sexpo-Sdecl   5.4  -0.9184102  11.71841 0.1165421</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co"># Sstat-Sdecl  -4.0 -10.3184102   2.31841 0.3360087</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co"># Sstat-Sexpo  -9.4 -15.7184102  -3.08159 0.0016145</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co"># the null hypothesis for each comparison is</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co"># grp1 - grp2 = 0 (i.e. no difference)</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co"># Sdecl-ASGM, Sexpo-ASGM, Sstat-ASGM and Sstat-Sexpo</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co"># are significantly different</span></span></code></pre></div>
<p> </p>
<p>14. We can also produce a plot of the comparisons to help us
interpret the table of comparisons. Use the <code>plot()</code> function
with the <code>TukeyHSD(gigartina.lm)</code>. Ask if you get stuck (or
Google it!).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(gigartina.lm), <span class="at">cex.axis =</span> <span class="fl">0.5</span>, <span class="at">las =</span> <span class="dv">2</span>)</span></code></pre></div>
<p> </p>
<p>15. Download the <em>‘TemoraBR.csv’</em> file from the <strong><a
href="data.html"><i class="fa fa-download"></i> Data</a></strong> link
and save it to the <code>data</code> directory. Import the dataset into
R and as usual assign it to a variable. These data are from an
experiment that was conducted to investigate the relationship between
temperature (<code>temp</code>) and the beat rate (Hz)
<code>beat_rate</code> of the copepod <a
href="https://en.wikipedia.org/wiki/Temora_longicornis"><em>Temora
longicornis</em></a> which had been acclimatised at three different
temperature regimes (<code>acclimitisation_temp</code>). Examine the
structure of the dataset. How many variables are there? What type of
variables are they? Which is the response (dependent) variable, and
which are the explanatory (independent) variables?</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>temora <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/TemoraBR.CSV&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>temora <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/TemoraBR.CSV&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">str</span>(temora)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co"># &#39;data.frame&#39;:\t45 obs. of 3 variables: $ temp : num 5 6 7 10 11 12 13 15 16 17 ...  $ beat_rate : num</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co"># 3.76 5.4 8 9.4 16.6 18.5 19...  $ acclimitisation_temp: int 5 5 5 5 5 5 5 5 5 5 ...</span></span></code></pre></div>
<p> </p>
<p>16. What type of variable is <code>acclimitisation_temp</code>? Is it
a factor? Convert <code>acclimitisation_temp</code> to a factor and
store the result in a new column in your dataframe called
<code>Facclimitisation_temp</code>. Hint: use the function
<code>factor()</code>. Use an appropriate plot to visualise these data
(perhaps a coplot or similar?).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>temora<span class="sc">$</span>Facclimitisation_temp <span class="ot">&lt;-</span> <span class="fu">factor</span>(temora<span class="sc">$</span>acclimitisation_temp)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co"># boxplot of beat rate and acclimitisation temp</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="fu">boxplot</span>(beat_rate <span class="sc">~</span> Facclimitisation_temp, <span class="at">data =</span> temora, <span class="at">xlab =</span> <span class="st">&quot;acclimitisation temp&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;beat rate&quot;</span>)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># scatter plot using the with function</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="fu">with</span>(temora, <span class="fu">plot</span>(beat_rate <span class="sc">~</span> temp, <span class="at">xlab =</span> <span class="st">&quot;temperature&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;beat rate&quot;</span>))</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co"># using a coplot</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="fu">coplot</span>(beat_rate <span class="sc">~</span> temp <span class="sc">|</span> Facclimitisation_temp, <span class="at">data =</span> temora)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co"># scatter plot with different symbols and colours</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="fu">with</span>(temora, <span class="fu">plot</span>(beat_rate <span class="sc">~</span> temp, <span class="at">xlab =</span> <span class="st">&quot;temperature&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;beat rate&quot;</span>, <span class="at">col =</span> <span class="fu">as.numeric</span>(Facclimitisation_temp),</span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">as.numeric</span>(Facclimitisation_temp)))</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;5&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;20&quot;</span>), <span class="at">pch =</span> <span class="fu">unique</span>(<span class="fu">as.numeric</span>(temora<span class="sc">$</span>Facclimitisation_temp)), <span class="at">col =</span> <span class="fu">unique</span>(<span class="fu">as.numeric</span>(temora<span class="sc">$</span>Facclimitisation_temp)))</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co"># or more flexibly</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="fu">plot</span>(beat_rate <span class="sc">~</span> temp, <span class="at">xlab =</span> <span class="st">&quot;temperature&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;beat rate&quot;</span>, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">data =</span> temora)</span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="fu">with</span>(temora, <span class="fu">points</span>(beat_rate[Facclimitisation_temp <span class="sc">==</span> <span class="st">&quot;5&quot;</span>] <span class="sc">~</span> temp[Facclimitisation_temp <span class="sc">==</span> <span class="st">&quot;5&quot;</span>], <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;black&quot;</span>))</span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="fu">with</span>(temora, <span class="fu">points</span>(beat_rate[Facclimitisation_temp <span class="sc">==</span> <span class="st">&quot;10&quot;</span>] <span class="sc">~</span> temp[Facclimitisation_temp <span class="sc">==</span> <span class="st">&quot;10&quot;</span>], <span class="at">pch =</span> <span class="dv">2</span>,</span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>))</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="fu">with</span>(temora, <span class="fu">points</span>(beat_rate[Facclimitisation_temp <span class="sc">==</span> <span class="st">&quot;20&quot;</span>] <span class="sc">~</span> temp[Facclimitisation_temp <span class="sc">==</span> <span class="st">&quot;20&quot;</span>], <span class="at">pch =</span> <span class="dv">3</span>,</span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>))</span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;5&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;20&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<p> </p>
<p>17. We will analyse these data using an Analysis of Covariance
(ANCOVA) to compare the slopes and the intercepts of the relationship
between <code>beat_rate</code> and <code>temp</code> for each level of
<code>Facclimatisation_temp</code>. Take a look at the plot you produced
in Q16, do you think the relationships are different?</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># the slope of the relationship between beat rate and temp</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># look different for each acclimitisation temp</span></span></code></pre></div>
<p> </p>
<p>18. As usual we will fit the model using the <code>lm()</code>
function. You will need to fit the main effects of <code>temp</code> and
<code>Facclimatisation_temp</code> and the interaction between
<code>temp</code> and <code>Facclimatisation_temp</code>. You can do
this using either of the equivalent specifications:</p>
<p><code>temp + Facclimatisation_temp + temp:Facclimatisation_temp</code>
or</p>
<p><code>temp * Facclimatisation_temp</code></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>temora.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(beat_rate <span class="sc">~</span> temp <span class="sc">+</span> Facclimitisation_temp <span class="sc">+</span> temp<span class="sc">:</span>Facclimitisation_temp, <span class="at">data =</span> temora)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co"># or equivalently</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>temora.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(beat_rate <span class="sc">~</span> temp <span class="sc">*</span> Facclimitisation_temp, <span class="at">data =</span> temora)</span></code></pre></div>
<p> </p>
<p>19. Produce the summary ANOVA table as usual. Is the interaction
between <code>temp</code> and <code>Facclimatisation_temp</code>
significant? What is the interpretation of the interaction term? Should
we interpret the main effects of <code>temp</code> and
<code>Facclimatisation_temp</code> as well?</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">anova</span>(temora.lm)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co"># Analysis of Variance Table</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co"># Response: beat_rate</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#                            Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co"># temp                        1 4293.7  4293.7 835.866 &lt; 2.2e-16 ***</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co"># Facclimitisation_temp       2 1197.7   598.8 116.576 &lt; 2.2e-16 ***</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co"># temp:Facclimitisation_temp  2  284.1   142.0  27.651 3.331e-08 ***</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co"># Residuals                  39  200.3     5.1   </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co"># there is a significant interaction between temp and </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co"># Facclimitisation_temp therefore there is a significant </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co"># relationship between beat_rate and temp, and this relationship </span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co"># is different depending on the level of Facclimitisation_temp.</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co"># Therefore we should not interpret the main effect of temp</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co"># or Facclimitisation_temp</span></span></code></pre></div>
<p> </p>
<p>20. Assess the assumptions of normality and equal variance of the
residuals in the usual way. Do the residuals meet these assumptions?
Discuss with a instructor.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">plot</span>(temora.lm)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># there is a hint of heterogeneity of variance (non equal variance)</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co"># as the variance increases with the fitted values. This is typical </span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co"># of count data.</span></span></code></pre></div>
<p> </p>
<p>21. Write a short summary in you R script (don’t forget to comment
this out with <code>#</code>) describing the interpretation of this
model. Report the appropriate summary statistics such as <em>F</em>
values, degrees of freedom and p values.</p>
<p> </p>
<p>22. (Optional) refit the model using the square root transformed
<code>beat_rate</code> as the response variable. Does the interpretation
of the model change? Do the validation plots of the residuals look
better?</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># we could try square root transforming the variable </span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co"># beat_rate to stabilise the variance</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># square root transform beat_rate and store in the dataframe</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>temora<span class="sc">$</span>SQRT_beatrate <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(temora<span class="sc">$</span>beat_rate)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co"># refit the model using the square root transformed data</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>temora.lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(SQRT_beatrate <span class="sc">~</span> temp <span class="sc">*</span> Facclimitisation_temp, <span class="at">data =</span> temora)</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="fu">plot</span>(temora.lm2)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co"># Residuals look a bit better</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co"># now lets look at the ANOVA table for our new model</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="fu">anova</span>(temora.lm2)</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co"># Analysis of Variance Table</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co"># Response: SQRT_beatrate</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co">#                            Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co"># temp                        1 67.916  67.916 712.1746 &lt; 2.2e-16 ***</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="co"># Facclimitisation_temp       2 17.600   8.800  92.2782 1.632e-15 ***</span></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="co"># temp:Facclimitisation_temp  2  1.151   0.576   6.0353  0.005205 ** </span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a><span class="co"># Residuals                  39  3.719   0.095                       </span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="co"># model has the same interpretation but the p value for the </span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="co"># interaction term is a bit larger.</span></span></code></pre></div>
<p> </p>
<p>End of Exercise 5</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
