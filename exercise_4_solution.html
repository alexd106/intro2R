<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exercise Solutions</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162377463-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162377463-2');
</script>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro2R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="setup.html">
    <span class="fa fa-cog"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    R Book
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://intro2r.com">
        <span class="fa fa-firefox"></span>
         
        Web book
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/alexd106/Rbook/raw/master/docs/Rbook.pdf">
        <span class="fa fa-file-pdf"></span>
         
        PDF book
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-university"></span>
     
    Learn R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="howto.html">
        <span class="fa fa-tv"></span>
         
        How-to
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="lectures.html">
        <span class="fa fa-chalkboard"></span>
         
        Lectures
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-file-contract"></span>
     
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exercises.html">
        <span class="fa fa-folder"></span>
         
        Excercises
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="exercise_solutions.html">
        <span class="fa fa-folder"></span>
         
        Exercise solutions
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="data.html">
    <span class="fa fa-download"></span>
     
    Data
  </a>
</li>
<li>
  <a href="Tutorials.html">
    <span class="fa fa-desktop"></span>
     
    Tutorials
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Info
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="syllabus.html">
        <span class="fa fa-graduation-cap"></span>
         
        Syllabus
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="People.html">
        <span class="fa fa-user-friends"></span>
         
        People
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="resources.html">
        <span class="fa fa-book"></span>
         
        Resources
      </a>
    </li>
    <li>
      <a href="https://forms.gle/U7MbyhRWyLomjyFY7">
        <span class="fa fa-commenting"></span>
         
        Feedback
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="People.html">
        <span class="fa fa-envelope fa-lg"></span>
         
        Contact
      </a>
    </li>
    <li>
      <a href="https://github.com/alexd106/intro2R">
        <span class="fa fa-github fa-lg"></span>
         
        Source code
      </a>
    </li>
    <li>
      <a href="https://twitter.com/Scedacity">
        <span class="fa fa-twitter fa-lg"></span>
         
        Twitter
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exercise Solutions</h1>

</div>


<p> </p>
<div id="exercise-4-visualising-data-using-base-r-and-lattice-graphics"
class="section level2">
<h2>Exercise 4: Visualising data using base R and lattice graphics</h2>
<p> </p>
<p>Read <a href="https://intro2r.com/graphics-base-r.html">Chapter 4</a>
to help you complete the questions in this exercise.</p>
<p> </p>
<p>1. As in previous exercises, either create a new R script or continue
with your previous R script in your RStudio Project. Again, make sure
you include any metadata you feel is appropriate (title, description of
task, date of creation etc) and don’t forget to comment out your
metadata with a <code>#</code> at the beginning of the line.</p>
<p> </p>
<p>2. Download the data file <em>‘squid1.xlsx’</em> from the <strong><a
href="data.html"><i class="fa fa-download"></i> Data</a></strong> link
and save it to the <code>data</code> directory you created during
exercise 1. Open this file in Microsoft Excel (or even better use an
open source equivalent - <a
href="https://www.libreoffice.org/download/download/">LibreOffice</a> is
a good free alternative) and save it as a tab delimited file type. Name
the file <em>‘squid1.txt’</em> and save it to the <code>data</code>
directory.</p>
<p> </p>
<p>3. These data were originally collected as part of a study published
in Aquatic Living Resources<sup>1</sup> in 2005. The aim of the study
was to investigate the seasonal patterns of investment in somatic and
reproductive tissues in the long finned squid <em>Loligo forbesi</em>
caught in Scottish waters. Squid were caught monthly from December 1989
- July 1991 (<code>month</code> and <code>year</code> variables). After
capture, each squid was given a unique <code>specimen</code> code,
weighed (<code>weight</code>) and the sex determined (<code>sex</code> -
only female squid are included here). The size of individuals was also
measured as the dorsal mantle length (<code>DML</code>) and the mantle
weight measured without internal organs
(<code>eviscerate.weight</code>). The gonads were weighed
(<code>ovary.weight</code>) along with the accessory reproductive organ
(the nidamental gland, <code>nid.weight</code>,
<code>nid.length</code>). Each individual was also assigned a
categorical measure of maturity (<code>maturity.stage</code>, ranging
from 1 to 5 with 1 = immature, 5 = mature). The digestive gland weight
(<code>dig.weight</code>) was also recorded to assess nutritional status
of the individual. If you’re not familiar with squid morphology and are
interested in finding out more see <a
href="https://en.wikipedia.org/wiki/Cephalopod_size">here</a>.</p>
<p> </p>
<p>4. Import the <em>‘squid1.txt’</em> file into R using the
<code>read.table()</code> function and assign it to a variable named
<code>squid</code>. Use the <code>str()</code> function to display the
structure of the dataset and the <code>summary()</code> function to
summarise the dataset. How many observations are in this dataset? How
many variables? The <code>year</code>, <code>month</code> and
<code>maturity.stage</code> variables were coded as integers in the
original dataset. Here we would like to code them as factors. Create a
new variable for each of these variables in the <code>squid</code>
dataframe and recode them as factors. Use the <code>str()</code>
function again to check the coding of these new variables.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>squid <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&#39;workshop/data/squid1.txt&#39;</span>, <span class="at">header =</span><span class="cn">TRUE</span>,</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>                    <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">str</span>(squid)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># &#39;data.frame&#39;: 519 obs. of  13 variables:</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#  $ sample.no        : int  105128901 105128901 105128901 105128901 ...</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#  $ specimen         : int  1002 1003 1005 1007 1008 1009 1011 1013 ...</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#  $ year             : int  1989 1989 1989 1989 1989 1989 1989 1989 ...</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#  $ month            : int  12 12 12 12 12 12 12 12 12 12 ...</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#  $ weight           : num  152 106 138 141 126 ...</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#  $ sex              : int  2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#  $ maturity.stage   : int  3 1 2 2 3 1 2 3 3 4 ...</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#  $ DML              : int  174 153 169 175 169 116 135 192 170 205 ...</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#  $ eviscerate.weight: num  87.5 62.6 79.4 83.1 72.2 ...</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#  $ dig.weight       : num  4.648 3.138 0.307 4.123 3.605 ...</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#  $ nid.length       : num  39.4 24.1 39 41.4 39.8 20 14 55 44 53 ...</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#  $ nid.weight       : num  2.46 0.319 1.169 1.631 2.03 ...</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#  $ ovary.weight     : num  1.68 0.103 0.289 0.252 0.86 ...</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="fu">summary</span>(squid)</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co"># convert variables to factors</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>squid<span class="sc">$</span>Fmaturity <span class="ot">&lt;-</span> <span class="fu">factor</span>(squid<span class="sc">$</span>maturity.stage)</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>squid<span class="sc">$</span>Fmonth <span class="ot">&lt;-</span> <span class="fu">factor</span>(squid<span class="sc">$</span>month) </span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>squid<span class="sc">$</span>Fyear <span class="ot">&lt;-</span> <span class="fu">factor</span>(squid<span class="sc">$</span>year)</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="fu">str</span>(squid)</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="co"># &#39;data.frame&#39;: 519 obs. of  16 variables:</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co">#  $ sample.no        : int  105128901 105128901 105128901 ...</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="co">#  $ specimen         : int  1002 1003 1005 1007 1008 1009 ...</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="co">#  $ year             : int  1989 1989 1989 1989 1989 1989 ...</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="co">#  $ month            : int  12 12 12 12 12 12 12 12 12 12 ...</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="co">#  $ weight           : num  152 106 138 141 126 ...</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="co">#  $ sex              : int  2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a><span class="co">#  $ maturity.stage   : int  3 1 2 2 3 1 2 3 3 4 ...</span></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a><span class="co">#  $ DML              : int  174 153 169 175 169 116 135 ...</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a><span class="co">#  $ eviscerate.weight: num  87.5 62.6 79.4 83.1 72.2 ...</span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="co">#  $ dig.weight       : num  4.648 3.138 0.307 4.123 3.605 ...</span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a><span class="co">#  $ nid.length       : num  39.4 24.1 39 41.4 39.8 20 14 ...</span></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a><span class="co">#  $ nid.weight       : num  2.46 0.319 1.169 1.631 2.03 ...</span></span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a><span class="co">#  $ ovary.weight     : num  1.68 0.103 0.289 0.252 0.86 ...</span></span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a><span class="co">#  $ Fmaturity        : Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot; &quot;5&quot;...</span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a><span class="co">#  $ Fmonth           : Factor w/ 12 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot; ...</span></span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a><span class="co">#  $ Fyear            : Factor w/ 3 levels &quot;1989&quot;,&quot;1990&quot;,..1 ...</span></span></code></pre></div>
<p> </p>
<p>5. How many observations are there per month and year combination
(hint: remember the <code>table()</code> or <code>xtabs()</code>
functions?)? Don’t forget to use the factor recoded versions of these
variables. Do you have data for each month in each year? Which years
have the most observations? (optional) Use a combination of the
<code>xtabs()</code> and <code>ftable()</code> functions to create a
flattened table of the number of observations for each year, maturity
stage and month (aka a contingency table).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">table</span>(squid<span class="sc">$</span>Fmonth, squid<span class="sc">$</span>Fyear)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="co">#   1989 1990 1991</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="co"># 1     0    3   37</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="co"># 2     0    0   30</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="co"># 3     0   40   29</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="co"># 4     0   10   33</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="co"># 5     0    1   30</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="co"># 6     0    0   14</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="co"># 7     0   42    1</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="co"># 8     0   29    0</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="co"># 9     0   82    0</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="co"># 10    0   19    0</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="co"># 11    0   76    0</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  <span class="co"># 12   12   31    0</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>  </span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">ftable</span>(<span class="fu">xtabs</span>(<span class="sc">~</span> Fyear <span class="sc">+</span> Fmaturity <span class="sc">+</span> Fmonth, <span class="at">data =</span> squid))</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#                 Fmonth  1  2  3  4  5  6  7  8  9 10 11 12</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co"># Fyear Fmaturity                                           </span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co"># 1989  1                 0  0  0  0  0  0  0  0  0  0  0  2</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#       2                 0  0  0  0  0  0  0  0  0  0  0  3</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#       3                 0  0  0  0  0  0  0  0  0  0  0  5</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#       4                 0  0  0  0  0  0  0  0  0  0  0  2</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#       5                 0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co"># 1990  1                 0  0  0  0  0  0  8  0  1  1  1  2</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#       2                 0  0  0  0  0  0 22 21 76 17 31  4</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#       3                 0  0  0  0  0  0  0  5  5  1 31  6</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#       4                 2  0 15  7  0  0  4  3  0  0 10 13</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#       5                 1  0 25  3  1  0  8  0  0  0  3  6</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co"># 1991  1                 0  0  0  2  0  4  0  0  0  0  0  0</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#       2                 1  1  0  1  0  6  0  0  0  0  0  0</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#       3                 2  0  0  1  1  0  0  0  0  0  0  0</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="co">#       4                16  8  6 13  6  1  1  0  0  0  0  0</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co">#       5                18 21 23 16 23  3  0  0  0  0  0  0</span></span></code></pre></div>
<p> </p>
<p>6. The humble cleveland dotplot is a great way of identifying if you
have potential outliers in continuous variables (See <a
href="https://intro2r.com/simple-base-r-plots.html#dotcharts">Section
4.2.4</a>). Create dotplots (using the <code>dotchart()</code> function)
for the following variables; <code>DML</code>, <code>weight</code>,
<code>nid.length</code> and <code>ovary.weight</code>. Do these
variables contain any unusually large or small observations? Don’t
forget, if you prefer to create a single figure with all 4 plots you can
always split your plotting device into 2 rows and 2 columns (see <a
href="https://intro2r.com/mult_graphs.html#mult_graphs">Section 4.4</a>
of the book). Use the <code>pdf()</code> function to save a pdf version
of your plot(s) in your <code>output</code> directory you created in
Exercise 1 (see <a
href="https://intro2r.com/export_plots.html#export_plots">Section
4.5</a> of the book to see how the <code>pdf()</code> function works). I
have also included some alternative code in the <a
href="exercise_4_solution.html">solutions for this exercise</a> using
the <code>dotplot()</code> function from the <code>lattice</code>
package.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&#39;figures/ex4_dotplots.pdf&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">dotchart</span>(squid<span class="sc">$</span>DML, <span class="at">main =</span> <span class="st">&quot;DML&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">dotchart</span>(squid<span class="sc">$</span>weight, <span class="at">main =</span> <span class="st">&quot;weight&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">dotchart</span>(squid<span class="sc">$</span>nid.length, <span class="at">main =</span> <span class="st">&quot;nid length&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">dotchart</span>(squid<span class="sc">$</span>ovary.weight, <span class="at">main =</span> <span class="st">&quot;ovary weight&quot;</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># alternative code using dotplot function from lattice package</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="fu">dotplot</span>(<span class="fu">as.matrix</span>(squid[,<span class="fu">c</span>(<span class="st">&quot;DML&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;nid.length&quot;</span>, <span class="st">&quot;ovary.weight&quot;</span>)]),</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>      <span class="at">groups=</span><span class="cn">FALSE</span>,</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>      <span class="at">strip =</span> <span class="fu">strip.custom</span>(<span class="at">bg =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>            <span class="at">par.strip.text =</span> <span class="fu">list</span>(<span class="at">cex =</span> <span class="fl">0.8</span>)),</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>        <span class="at">scales =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">list</span>(<span class="at">relation =</span> <span class="st">&quot;free&quot;</span>),</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">list</span>(<span class="at">relation =</span> <span class="st">&quot;free&quot;</span>),</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>                      <span class="at">draw =</span> <span class="cn">FALSE</span>),</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>        <span class="at">col=</span><span class="dv">1</span>, <span class="at">cex  =</span><span class="fl">0.5</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Value of the variable&quot;</span>,</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Order of the data from text file&quot;</span>)</span></code></pre></div>
<p> </p>
<p>7. It looks like the variable <code>nid.length</code> contains an
unusually large value. Actually, this value is biologically implausible
and clearly an error. The researchers were asked to go back and check
their field notebooks and sure enough they discover a typo. It looks
like a tired researcher accidentally inserted a zero by mistake when
transcribing these data (mistakes in data are very common and why we
<strong>always</strong> explore, check and validate any data we are
working on). We can clearly see this value is over 400 so we can use the
<code>which()</code> function to identify which observation this is
<code>which(squid$nid.length &gt; 400)</code>. It looks like this is the
11<sup>th</sup> observation of the <code>squid$nid.length</code>
variable. Use your skill with the square brackets <code>[ ]</code> to
first confirm the this is the correct value (you should get 430.2) and
then change this value to 43.2. Now redo the dotchart to visualise your
correction. Caution: You can only do this because you have confirmed
that this is an transcribing error. You should <strong>not</strong>
remove or change values in your data just because you feel like it or
they look ‘unusual’. This is scientific fraud! Also, the advantage of
making this change in your R script rather than in Excel is that you now
have a permanent record of the change you made and can state a clear
reason for the change.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">which</span>(squid<span class="sc">$</span>nid.length <span class="sc">&gt;</span> <span class="dv">400</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># [1] 11</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>squid<span class="sc">$</span>nid.length[<span class="dv">11</span>]</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># [1] 430.2</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>squid<span class="sc">$</span>nid.length[<span class="dv">11</span>] <span class="ot">&lt;-</span> <span class="fl">43.2</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>squid<span class="sc">$</span>nid.length[<span class="dv">11</span>]</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co"># [1] 43.2</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">dotchart</span>(squid<span class="sc">$</span>nid.length, <span class="at">main =</span> <span class="st">&quot;nid length&quot;</span>)</span></code></pre></div>
<p> </p>
<p>8. When exploring your data it is often useful to visualise the
distribution of continuous variables. Take a look at <a
href="https://intro2r.com/simple-base-r-plots.html#histograms">Section
4.2.2</a> and then create histograms for the variables;
<code>DML</code>, <code>weight</code>, <code>eviscerate.weight</code>
and <code>ovary.weight</code>. Again, its up to you if you want to plot
all 4 plots separately or in the same figure. Export your plot(s) as pdf
file(s) to the <code>output</code> directory. One potential problem with
histograms is that the distribution of data can look quite different
depending on the number of ‘breaks’ used. The <code>hist()</code>
function does it’s best to create appropriate ‘breaks’ for your plots
(it uses the <a href="https://en.wikipedia.org/wiki/Histogram">Sturges
algorithm</a> for those that want to know) but experiment with changing
the number of breaks for the <code>DML</code> variable to see how the
shape of the distribution changes (see <a
href="https://intro2r.com/simple-base-r-plots.html#histograms">Section
4.2.2</a> of the book for further details of how to change the
breaks).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&#39;workshop/figures/ex4_hist.pdf&#39;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">hist</span>(squid<span class="sc">$</span>DML, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;DML&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">hist</span>(squid<span class="sc">$</span>weight, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;weight&quot;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">hist</span>(squid<span class="sc">$</span>eviscerate.weight, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;eviscerate weight&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">hist</span>(squid<span class="sc">$</span>ovary.weight, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ovary weight&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co"># need to get the min and max values for DML</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co"># to work out the limits for the breaks</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="fu">summary</span>(squid<span class="sc">$</span>DML)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#   88     187     217     215     240     323 </span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a> </span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co"># experimenting with different breaks</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>brk1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">80</span>, <span class="at">to =</span> <span class="dv">340</span>, <span class="at">by =</span> <span class="dv">20</span>)   </span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="fu">hist</span>(squid<span class="sc">$</span>DML, <span class="at">xlab =</span> <span class="st">&quot;DML&quot;</span>, <span class="at">breaks =</span> brk1, <span class="at">main =</span> <span class="st">&quot;brk: 20&quot;</span>)</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>brk2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">80</span>, <span class="at">to =</span> <span class="dv">340</span>, <span class="at">by =</span> <span class="dv">10</span>)   </span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="fu">hist</span>(squid<span class="sc">$</span>DML, <span class="at">xlab =</span> <span class="st">&quot;DML&quot;</span>, <span class="at">breaks =</span> brk2, <span class="at">main =</span> <span class="st">&quot;brk: 10&quot;</span>)</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>brk3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">80</span>, <span class="at">to =</span> <span class="dv">340</span>, <span class="at">by =</span> <span class="dv">5</span>)   </span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="fu">hist</span>(squid<span class="sc">$</span>DML, <span class="at">xlab =</span> <span class="st">&quot;DML&quot;</span>, <span class="at">breaks =</span> brk3, <span class="at">main =</span> <span class="st">&quot;brk: 5&quot;</span>)</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>brk4 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">80</span>, <span class="at">to =</span> <span class="dv">340</span>, <span class="at">by =</span> <span class="dv">2</span>)   </span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="fu">hist</span>(squid<span class="sc">$</span>DML, <span class="at">xlab =</span> <span class="st">&quot;DML&quot;</span>, <span class="at">breaks =</span> brk4, <span class="at">main =</span> <span class="st">&quot;brk: 2&quot;</span>)</span></code></pre></div>
<p> </p>
<p>9. Scatterplots are great for visualising relationships between two
continuous variables (<a
href="https://intro2r.com/simple-base-r-plots.html#scatterplot">Section
4.2.1</a>). Plot the relationship between <code>DML</code> on the x axis
and <code>weight</code> on the y axis. How would you describe this
relationship? Is it linear? One approach to linearising relationships is
to apply a transformation on one or both variables. Try transforming the
<code>weight</code> variable with either a natural log
(<code>log()</code>) or square root (<code>sqrt()</code>)
transformation. I suggest you create new variables in the
<code>squid</code> dataframe for your transformed variables and use
these variables when creating your new plots (ask if you’re not sure how
to do this). Which transformation best linearises this relationship?
Again, save your plots as a pdf file (or try saving in your
<code>output</code> directory as jpeg or png format using the
<code>jpeg()</code> or <code>png()</code> functions - <a
href="https://intro2r.com/export_plots.html#export_plots">Section
4.5</a> if you feel the need for a change!).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># clearly not linear</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">plot</span>(squid<span class="sc">$</span>DML, squid<span class="sc">$</span>weight)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># natural log and sqrt tranform weight</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>squid<span class="sc">$</span>weight.sqrt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(squid<span class="sc">$</span>weight)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>squid<span class="sc">$</span>weight.log <span class="ot">&lt;-</span> <span class="fu">log</span>(squid<span class="sc">$</span>weight)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="fu">plot</span>(squid<span class="sc">$</span>DML, squid<span class="sc">$</span>weight.sqrt)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="fu">plot</span>(squid<span class="sc">$</span>DML, squid<span class="sc">$</span>weight.log)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co"># the square root transformation looks</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co"># most appropriate</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="fu">jpeg</span>(<span class="st">&#39;output/ex4_transf_plot.jpeg&#39;</span>)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">plot</span>(squid<span class="sc">$</span>DML, squid<span class="sc">$</span>weight.sqrt)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&#39;output/ex4_transf_plot.png&#39;</span>)</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="fu">plot</span>(squid<span class="sc">$</span>DML, squid<span class="sc">$</span>weight.sqrt)</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p> </p>
<p>10. When visualising differences in a continuous variable between
levels of a factor (categorical variable) then a boxplot is your friend
(avoid using bar plots - Google ‘bar plots are evil’ for more info).
Create a boxplot to visualise the differences in DML at each maturity
stage (don’t forget to use the recoded version of this variable you
created in Q4) . Include x and y axes labels in your plot. Make sure you
understand the anatomy of a boxplot before moving on - please ask if
you’re not sure (also see <a
href="https://intro2r.com/simple-base-r-plots.html#box-and-violin-plots">Section
4.2.3</a> of the book). An alternative to the boxplot is the violin
plot. A violin plot is a combination of a boxplot and a <a
href="https://www.statmethods.net/graphs/density.html">kernel density
plot</a> and is great at visualising the distribution of a variable. To
create a violin plot you will first need to install the
<code>vioplot</code> package from CRAN and make it available using
<code>library(vioplot)</code>. You can now use the
<code>vioplot()</code> function in pretty much the same way as you
created your boxplot (again <a
href="https://intro2r.com/simple-base-r-plots.html#box-and-violin-plots">Section
4.2.3</a> of the book walks you through this).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># note: Fmaturity is the recoded maturity.stage variable cerated in Q4</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">boxplot</span>(DML <span class="sc">~</span> Fmaturity, <span class="at">data =</span> squid, <span class="at">xlab =</span> <span class="st">&quot;maturity stage&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;DML&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># violin plot</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">library</span>(vioplot)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">vioplot</span>(DML <span class="sc">~</span> Fmaturity, <span class="at">data =</span> squid, <span class="at">xlab =</span> <span class="st">&quot;maturity stage&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;DML&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<p> </p>
<p>11. To visualise the relationship between two continuous variables
but for different levels of a factor variable you can create a
conditional scatterplot. Use the <code>coplot()</code> function (<a
href="https://intro2r.com/simple-base-r-plots.html#coplots">Section
4.2.6</a>) to plot the relationship between DML on the x axis and square
root transformed weight on the y axis (you created this variable in Q8)
for each level of maturity stage. Does the relationship between DML and
weight look different for each maturity stage (suggesting an
interaction)? If you prefer, you can also create a similar plot using
the <code>xyplot()</code> function (<a
href="https://intro2r.com/simple-base-r-plots.html#lattice-plots">Section
4.2.7</a>) from the <code>lattice</code> package (don’t forget to make
the function available by using <code>library(lattice)</code>
first).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">coplot</span>(weight.sqrt <span class="sc">~</span> DML <span class="sc">|</span> Fmaturity, <span class="at">data =</span> squid)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># using xyplot from the lattice package</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">xyplot</span>(weight.sqrt <span class="sc">~</span> DML <span class="sc">|</span> Fmaturity, <span class="at">data =</span> squid)</span></code></pre></div>
<p> </p>
<p>12. To explore the relationships between multiple continuous
variables it’s hard to beat a pairs plot. Create a pairs plot for the
variables; <code>DML</code>, <code>weight</code>,
<code>eviscerate.weight</code>, <code>ovary.weight</code>,
<code>nid.length</code>, and <code>nid.weight</code> (see <a
href="https://intro2r.com/simple-base-r-plots.html#pairs-plots">Section
4.2.5</a> of the book for more details). If it looks a little cramped in
RStudio then click on the ‘zoom’ button in the plot viewer to see a
larger version. One of the great things about the <code>pairs()</code>
function is that you can customise what goes into each panel. Modify
your pairs plot to include a histogram of the variables on the diagonal
panel and include a correlation coefficient for each relationship on the
upper triangle panels. Also include a smoother (wiggly line) in the
lower triangle panels to help visualise these relationships. Take a look
at the Introduction to R book to see how to do all this (or
<code>?pairs</code>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># vanilla pairs plot</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">pairs</span>(squid[, <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>)])</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># customise the plot. You will need to define the panel.hist and panel.cor functions first. see the</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># course manual or ?pairs help file</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">pairs</span>(squid[, <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>)], <span class="at">diag.panel =</span> panel.hist, <span class="at">upper.panel =</span> panel.cor, <span class="at">lower.panel =</span> panel.smooth)</span></code></pre></div>
<p> </p>
<p>13. Almost every aspect of the figures you create in R is
customisable. Learning how to get your plot looking just right is not
only rewarding but also means that you will never have to include a plot
in your paper/thesis that you’re not completely happy with. When you
start learning how to use R it can sometimes seem to take a lot of work
to customise your plots. Don’t worry, it gets easier with experience
(most of the time anyway) and you will always have your code if you want
to create a similar plot in the future. Use the <code>plot()</code>
function to produce a scatterplot of DML on the x axis and ovary weight
on the y axis (you might need to apply a transformation on the variable
<code>ovary.weight</code>). Use a different colour to highlight points
for each level of maturity stage. Produce a legend explaining the
different colours and place it in a suitable position on the plot.
Format the graph further to make it suitable for inclusion into your
paper/thesis (i.e. add axes labels, change the axes scales etc). See <a
href="https://intro2r.com/custom_plot.html#custom_plot">Section 4.3</a>
for more details about customising plots. I have given you a few
different solutions in the code below. give them a go!</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># quick and dirty way</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># need to transform ovary.weight first</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>squid<span class="sc">$</span>ovary.weight.sqrt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(squid<span class="sc">$</span>ovary.weight)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># create the plot</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="fu">with</span>(squid, <span class="fu">plot</span>(DML, ovary.weight.sqrt, <span class="at">xlab =</span> <span class="st">&quot;DML (mm)&quot;</span>, </span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">&quot;square root ovary weight (g)&quot;</span>, </span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>                 <span class="at">col =</span> <span class="fu">as.numeric</span>(Fmaturity), </span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>                 <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">350</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">8.5</span>)))</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co"># create the legend</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;stage 1&quot;</span>, <span class="st">&quot;stage 2&quot;</span>, <span class="st">&quot;stage 3&quot;</span>, <span class="st">&quot;stage 4&quot;</span>,<span class="st">&quot;stage 5&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">levels</span>(squid<span class="sc">$</span>Fmaturity))</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, labs,<span class="at">col =</span> cols, <span class="at">pch =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># longer but more control</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co"># need to scales package to set transparency of points</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># will the alpha function</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#setup the axes but dont plot the points</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="fu">with</span>(squid, <span class="fu">plot</span>(DML, ovary.weight.sqrt, <span class="at">xlab =</span> <span class="st">&quot;DML (mm)&quot;</span>, </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>                 <span class="at">ylab =</span> <span class="st">&quot;square root ovary weight (g)&quot;</span>,</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">350</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">8.5</span>)))</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co"># plot the points with custom colours</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">with</span>(squid, <span class="fu">points</span>(DML[Fmaturity <span class="sc">==</span> <span class="st">&quot;1&quot;</span>], ovary.weight.sqrt[Fmaturity <span class="sc">==</span> <span class="st">&quot;1&quot;</span>], </span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>                   <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;deepskyblue3&quot;</span>, <span class="fl">0.7</span>), <span class="at">pch =</span> <span class="dv">16</span>))</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">with</span>(squid, <span class="fu">points</span>(DML[Fmaturity <span class="sc">==</span> <span class="st">&quot;2&quot;</span>], ovary.weight.sqrt[Fmaturity <span class="sc">==</span> <span class="st">&quot;2&quot;</span>], </span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>                   <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;darkolivegreen3&quot;</span>, <span class="fl">0.7</span>), <span class="at">pch =</span> <span class="dv">16</span>))</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="fu">with</span>(squid, <span class="fu">points</span>(DML[Fmaturity <span class="sc">==</span> <span class="st">&quot;3&quot;</span>], ovary.weight.sqrt[Fmaturity <span class="sc">==</span> <span class="st">&quot;3&quot;</span>], </span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>                   <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;coral3&quot;</span>, <span class="fl">0.7</span>), <span class="at">pch =</span> <span class="dv">16</span>))</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="fu">with</span>(squid, <span class="fu">points</span>(DML[Fmaturity <span class="sc">==</span> <span class="st">&quot;4&quot;</span>], ovary.weight.sqrt[Fmaturity <span class="sc">==</span> <span class="st">&quot;4&quot;</span>], </span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>                   <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;lemonchiffon3&quot;</span>, <span class="fl">0.7</span>), <span class="at">pch =</span> <span class="dv">16</span>))</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="fu">with</span>(squid, <span class="fu">points</span>(DML[Fmaturity <span class="sc">==</span> <span class="st">&quot;5&quot;</span>], ovary.weight.sqrt[Fmaturity <span class="sc">==</span> <span class="st">&quot;5&quot;</span>], </span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>                   <span class="at">col =</span> <span class="fu">alpha</span>(<span class="st">&quot;darkorchid3&quot;</span>, <span class="fl">0.7</span>), <span class="at">pch =</span> <span class="dv">16</span>))</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>    </span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co"># include the legend</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;stage 1&quot;</span>, <span class="st">&quot;stage 2&quot;</span>, <span class="st">&quot;stage 3&quot;</span>, <span class="st">&quot;stage 4&quot;</span>,<span class="st">&quot;stage 5&quot;</span>)</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;deepskyblue3&quot;</span>, <span class="st">&quot;darkolivegreen3&quot;</span>, <span class="st">&quot;coral3&quot;</span>, </span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>          <span class="st">&quot;lemonchiffon3&quot;</span>, <span class="st">&quot;darkorchid3&quot;</span>)</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">55</span>, <span class="fl">8.2</span>, labs,<span class="at">col =</span> <span class="fu">alpha</span>(cols, <span class="fl">0.7</span>), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># or use the ggplot2 package</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># square root transform ovary weight</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>squid<span class="sc">$</span>ovary.weight.sqrt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(squid<span class="sc">$</span>ovary.weight)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> squid) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> DML, <span class="at">y =</span> ovary.weight.sqrt, <span class="at">colour =</span> Fmaturity), </span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;deepskyblue3&quot;</span>, <span class="st">&quot;darkolivegreen3&quot;</span>, <span class="st">&quot;coral3&quot;</span>, </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>                                 <span class="st">&quot;lemonchiffon3&quot;</span>, <span class="st">&quot;darkorchid3&quot;</span>), </span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;stage 1&quot;</span>, <span class="st">&quot;stage 2&quot;</span>, <span class="st">&quot;stage 3&quot;</span>, </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>                                 <span class="st">&quot;stage 4&quot;</span>, <span class="st">&quot;stage 5&quot;</span>)) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;DML (mm)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;square root ovary weight (g)&quot;</span>)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> squid) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> DML, <span class="at">y =</span> ovary.weight.sqrt, <span class="at">colour =</span> Fmaturity), </span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;DML (mm)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;square root ovary weight (g)&quot;</span>)</span></code></pre></div>
<p> </p>
<p><sup>1</sup> Smith JM et al (2005) Seasonal patterns of investment in
reproductive and somatic tissues in the squid <em>Loligo forbesi</em>,
Aquatic Living Resources. 18, 341–351.</p>
<p> </p>
<p>End of Exercise 4</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
